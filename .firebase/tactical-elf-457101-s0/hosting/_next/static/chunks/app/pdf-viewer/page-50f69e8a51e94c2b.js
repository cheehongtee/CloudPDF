(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[912],{3320:(e,t,a)=>{Promise.resolve().then(a.bind(a,8176))},3741:(e,t,a)=>{"use strict";a.d(t,{$:()=>l});var r=a(5155);function l(e){let{className:t,variant:a="default",size:l="default",children:s,...i}=e,n={default:"bg-blue-600 text-white hover:bg-blue-700/90 dark:bg-blue-500 dark:hover:bg-blue-400/90",outline:"border border-gray-300 dark:border-gray-600 bg-transparent hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-gray-100",ghost:"hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-gray-100"},d={default:"h-10 py-2 px-4",sm:"h-9 px-3 rounded-md",lg:"h-11 px-8 rounded-md",icon:"h-10 w-10"},o=n[a]||n.default,c=d[l]||d.default;return(0,r.jsx)("button",{className:"".concat("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background dark:focus-visible:ring-offset-gray-800"," ").concat(o," ").concat(c," ").concat(t).trim(),...i,children:s})}a(2115)},5494:(e,t,a)=>{"use strict";a.d(t,{A:()=>m});var r=a(5155),l=a(6874),s=a.n(l),i=a(9576),n=a(5695),d=a(7434),o=a(3783),c=a(3428),u=a(3408),x=a(4835);function m(){let{user:e,logout:t}=(0,i.A)(),a=(0,n.useRouter)(),l=async()=>{try{await t(),a.push("/auth/login")}catch(e){console.error("Failed to log out",e)}};return(0,r.jsx)("nav",{className:"bg-white dark:bg-gray-800 shadow-md sticky top-0 z-50",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,r.jsxs)(s(),{href:"/",className:"flex items-center space-x-2 text-2xl font-bold text-blue-600 dark:text-blue-400",children:[(0,r.jsx)(d.A,{size:24}),(0,r.jsx)("span",{children:"CloudPDF"})]}),e&&(0,r.jsxs)("div",{className:"hidden md:flex space-x-1 items-center border-l border-gray-200 dark:border-gray-700 pl-4",children:[(0,r.jsxs)(g,{href:"/dashboard",children:[(0,r.jsx)(o.A,{size:18,className:"mr-1"}),"Dashboard"]}),(0,r.jsxs)(g,{href:"/pdf-viewer",children:[(0,r.jsx)(d.A,{size:18,className:"mr-1"}),"Viewer"]}),(0,r.jsxs)(g,{href:"/pdf-tools/merge",children:[(0,r.jsx)(c.A,{size:18,className:"mr-1"}),"Merge"]}),(0,r.jsxs)(g,{href:"/pdf-tools/split",children:[(0,r.jsx)(u.A,{size:18,className:"mr-1"}),"Split"]})]})]}),(0,r.jsx)("div",{className:"flex items-center",children:e?(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("span",{className:"hidden sm:inline text-sm text-gray-600 dark:text-gray-300",children:e.email}),(0,r.jsx)("button",{onClick:l,title:"Logout",className:"flex items-center p-2 rounded-md text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-700 dark:hover:text-gray-200 transition-colors",children:(0,r.jsx)(x.A,{size:20})})]}):(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(s(),{href:"/auth/login",className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 transition-colors rounded-md",children:"Login"}),(0,r.jsx)(s(),{href:"/auth/register",className:"inline-flex items-center rounded-md bg-blue-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-500 dark:bg-blue-500 dark:hover:bg-blue-400 transition-colors",children:"Register"})]})})]})})})}function g(e){let{href:t,children:a}=e;return(0,r.jsx)(s(),{href:t,className:"flex items-center px-3 py-2 text-sm font-medium text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",children:a})}},6104:(e,t,a)=>{"use strict";a.d(t,{IG:()=>c,db:()=>d,j2:()=>o});var r=a(3915),l=a(5317),s=a(6203),i=a(858);let n=(0,r.Dk)().length?(0,r.Sx)():(0,r.Wp)({apiKey:"AIzaSyDI7MAPqIvl1cCkwZl_Nr4bYmOArNzIqzM",authDomain:"tactical-elf-457101-s0.firebaseapp.com",projectId:"tactical-elf-457101-s0",storageBucket:"tactical-elf-457101-s0.firebasestorage.app",messagingSenderId:"695823233926",appId:"1:695823233926:web:aeac2bc2b5069d8baa7207",measurementId:"G-JQF8DMHYSF"}),d=(0,l.aU)(n),o=(0,s.xI)(n),c=(0,i.c7)(n)},8176:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>w});var r=a(5155),l=a(2115),s=a(4014),i=a(5404),n=a(9280);a(8851),a(2465);var d=a(5494),o=a(9053),c=a(9576),u=a(6104),x=a(858),m=a(5317),g=a(3741),f=a(2337),h=a(9946);let b=(0,h.A)("type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);var p=a(5339);let v=(0,h.A)("file-check",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);var y=a(1154);let j=(0,h.A)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);var k=a(4123);function w(){let{user:e}=(0,c.A)(),[t,a]=(0,l.useState)(null),[s,h]=(0,l.useState)(null),[w,N]=(0,l.useState)(1),[A,S]=(0,l.useState)(null),[F,C]=(0,l.useState)(!1),[P,z]=(0,l.useState)(0),[D,V]=(0,l.useState)(null),[E,I]=(0,l.useState)(null),[U,M]=(0,l.useState)(null),R=(0,l.useRef)(null),[B,L]=(0,l.useState)(!1),[T,H]=(0,l.useState)({x:0,y:0,value:"",isVisible:!1,pageNum:1}),[_,$]=(0,l.useState)(!1),q=(0,l.useCallback)(e=>{M(e)},[]),O=async()=>{if(t&&""!==T.value.trim()&&U){$(!0);try{var e,r;let l=await t.arrayBuffer(),s=await k.PDFDocument.load(l),i=await s.embedFont(k.StandardFonts.Helvetica),n=s.getPages()[T.pageNum-1],{width:d,height:o}=n.getSize(),c=d/U.width,u=null!=(r=null==(e=R.current)?void 0:e.getBoundingClientRect().height)?r:o,x=T.x*c,m=u*c-T.y*c-12*c;n.drawText(T.value,{x:x,y:m,size:12,font:i,color:(0,k.rgb)(0,.53,.71)});let g=await s.save(),f=new Blob([g],{type:"application/pdf"}),h=new File([f],t.name,{type:"application/pdf"});a(h),H({...T,isVisible:!1,value:""})}catch(e){console.error("Failed to add text to PDF:",e),S("Could not add text to the PDF.")}finally{$(!1)}}};function K(e){if(T.isVisible)return void alert("Please save or cancel the current text before changing pages.");N(t=>t+e)}return(0,r.jsx)(o.A,{children:(0,r.jsxs)("div",{className:"min-h-screen flex flex-col",children:[(0,r.jsx)(d.A,{}),(0,r.jsxs)("main",{className:"flex-grow container mx-auto px-4 sm:px-6 lg:px-8 py-12 w-full",children:[(0,r.jsx)("h1",{className:"text-2xl font-semibold mb-4 text-center text-gray-800 dark:text-gray-200",children:"CloudPDF Viewer & Uploader"}),(0,r.jsxs)("div",{className:"mb-4 flex flex-col sm:flex-row items-center justify-center gap-4 p-4 bg-gray-100 dark:bg-gray-800 rounded-md shadow",children:[(0,r.jsx)("input",{type:"file",onChange:function(e){var t;let r=null==(t=e.target.files)?void 0:t[0];if(r&&"application/pdf"===r.type){let e=new FileReader;e.onload=e=>{var t;(null==(t=e.target)?void 0:t.result)&&(a(new File([new Blob([e.target.result],{type:"application/pdf"})],r.name,{type:"application/pdf"})),S(null),V(null),I(null),h(null),N(1),L(!1),H({x:0,y:0,value:"",isVisible:!1,pageNum:1}))},e.readAsArrayBuffer(r)}else S("Please upload a valid PDF file."),a(null),V(null),I(null)},accept:"application/pdf",className:"block w-full max-w-xs text-sm text-gray-500 dark:text-gray-400 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border file:border-gray-300 dark:file:border-gray-600 file:text-sm file:font-semibold file:bg-white dark:file:bg-gray-700 file:text-blue-700 dark:file:text-blue-300 hover:file:bg-gray-50 dark:hover:file:bg-gray-600"}),(0,r.jsx)(g.$,{onClick:()=>{if(!t||!e)return void V("No file selected or user not logged in.");if(T.isVisible)return void V("Please save or cancel the text you are adding before uploading.");C(!0),V(null),I(null),z(0);let a=(0,x.KR)(u.IG,"users/".concat(e.uid,"/pdfs/").concat(t.name)),r=(0,x.bp)(a,t);r.on("state_changed",e=>{z(e.bytesTransferred/e.totalBytes*100)},e=>{console.error("Upload Error:",e),V("Upload failed: ".concat(e.message)),C(!1),z(0)},async()=>{try{let a=await (0,x.qk)(r.snapshot.ref);I(a),console.log("File available at",a);let l=(0,m.rJ)(u.db,"users",e.uid,"uploadedPdfs");await (0,m.gS)(l,{fileName:t.name,downloadURL:a,uploadedAt:(0,m.O5)()}),console.log("File metadata saved to Firestore")}catch(e){console.error("Error getting download URL or saving metadata:",e),V("Upload complete but failed to save metadata or get URL.")}finally{C(!1)}})},disabled:!t||F||B,size:"default",title:B?"Disable 'Add Text' mode before uploading":"Upload current PDF to cloud",children:F?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Uploading..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(f.A,{className:"mr-2 h-4 w-4"})," Upload to Cloud"]})}),(0,r.jsxs)(g.$,{variant:B?"default":"outline",onClick:()=>{L(!B),H({...T,isVisible:!1})},disabled:!t||F,size:"default",title:"Toggle Add Text Mode",children:[(0,r.jsx)(b,{className:"mr-2 h-4 w-4"})," ",B?"Cancel Text":"Add Text"]})]}),F&&(0,r.jsxs)("div",{className:"mb-4 max-w-md mx-auto",children:[(0,r.jsx)("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5",children:(0,r.jsx)("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all duration-300 ease-out",style:{width:"".concat(P,"%")}})}),(0,r.jsxs)("p",{className:"text-center text-sm text-gray-600 dark:text-gray-400 mt-1",children:[Math.round(P),"%"]})]}),D&&(0,r.jsxs)("div",{className:"bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-200 px-4 py-2 rounded text-sm text-center mb-4 max-w-md mx-auto flex items-center justify-center gap-2",children:[(0,r.jsx)(p.A,{size:16})," ",D]}),E&&(0,r.jsxs)("div",{className:"bg-green-100 dark:bg-green-900 border border-green-400 dark:border-green-700 text-green-700 dark:text-green-200 px-4 py-2 rounded text-sm text-center mb-4 max-w-md mx-auto flex items-center justify-center gap-2",children:[(0,r.jsx)(v,{size:16})," Upload Successful! Metadata saved."]}),A&&(0,r.jsxs)("div",{className:"w-full max-w-4xl bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-200 px-4 py-3 rounded text-center mb-4 flex items-center justify-center gap-2",children:[(0,r.jsx)(p.A,{size:16})," ",A]}),(0,r.jsxs)("div",{className:"flex flex-col items-center relative",children:[t&&(0,r.jsxs)("div",{ref:R,className:"border shadow-lg overflow-auto max-w-full bg-white dark:bg-gray-900 relative",style:{maxHeight:"calc(100vh - 300px)",cursor:B?"crosshair":"default"},onClick:e=>{if(!B||!U||!R.current)return;let t=R.current.getBoundingClientRect();U.width,t.width,H({x:e.clientX-t.left-5,y:e.clientY-t.top-10,value:"",isVisible:!0,pageNum:w})},children:[(0,r.jsx)(i.A,{file:t,onLoadSuccess:function(e){let{numPages:t}=e;h(t),N(1),S(null),L(!1),H({x:0,y:0,value:"",isVisible:!1,pageNum:1})},onLoadError:function(e){console.error("Error loading PDF document:",e),S("Failed to load PDF document. Ensure it is a valid PDF file."),a(null),h(null),L(!1)},loading:(0,r.jsx)(y.A,{className:"h-8 w-8 animate-spin text-blue-600 mx-auto my-10"}),children:(0,r.jsx)(n.A,{pageNumber:w,renderTextLayer:!1,onLoadSuccess:q})}),T.isVisible&&T.pageNum===w&&(0,r.jsxs)("div",{className:"absolute p-1 bg-white border border-blue-500 shadow-lg rounded",style:{left:"".concat(T.x,"px"),top:"".concat(T.y,"px"),zIndex:10},children:[(0,r.jsx)("textarea",{value:T.value,onChange:e=>H({...T,value:e.target.value}),placeholder:"Enter text...",autoFocus:!0,className:"w-48 h-16 p-1 border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500 text-sm",onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),O())}}),(0,r.jsxs)("div",{className:"mt-1 flex justify-end gap-1",children:[(0,r.jsx)(g.$,{size:"sm",variant:"ghost",onClick:()=>H({...T,isVisible:!1,value:""}),title:"Cancel",className:"px-2 py-1 text-xs",children:"Cancel"}),(0,r.jsxs)(g.$,{size:"sm",onClick:O,disabled:_||""===T.value.trim(),title:"Save Text (Enter)",className:"px-2 py-1 text-xs",children:[_?(0,r.jsx)(y.A,{className:"h-3 w-3 animate-spin"}):(0,r.jsx)(j,{className:"h-3 w-3"}),"Save"]})]})]})]}),t&&s&&(0,r.jsxs)("div",{className:"mt-4 flex items-center gap-4",children:[(0,r.jsx)(g.$,{variant:"outline",size:"sm",disabled:w<=1||T.isVisible,onClick:function(){K(-1)},title:T.isVisible?"Save or cancel text first":"Previous Page",children:"Previous"}),(0,r.jsxs)("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:["Page ",w," of ",s]}),(0,r.jsx)(g.$,{variant:"outline",size:"sm",disabled:w>=s||T.isVisible,onClick:function(){K(1)},title:T.isVisible?"Save or cancel text first":"Next Page",children:"Next"})]}),!t&&!A&&(0,r.jsx)("div",{className:"text-center text-gray-500 dark:text-gray-400 mt-10 border border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-10",children:(0,r.jsx)("p",{children:"Select a PDF file using the button above to view and upload."})})]})]})]})})}s.EA.workerSrc="//unpkg.com/pdfjs-dist@".concat(s.rE,"/build/pdf.worker.min.mjs")},9053:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});var r=a(5155),l=a(2115),s=a(5695),i=a(9576);function n(e){let{children:t}=e,{user:a,loading:n}=(0,i.A)(),d=(0,s.useRouter)();return((0,l.useEffect)(()=>{n||a||d.push("/auth/login")},[a,n,d]),n)?(0,r.jsx)("div",{className:"flex h-screen items-center justify-center",children:(0,r.jsx)("div",{className:"h-8 w-8 animate-spin rounded-full border-b-2 border-t-2 border-blue-600"})}):a?(0,r.jsx)(r.Fragment,{children:t}):null}},9576:(e,t,a)=>{"use strict";a.d(t,{A:()=>o,AuthProvider:()=>c});var r=a(5155),l=a(2115),s=a(6203),i=a(6104),n=a(5317);let d=(0,l.createContext)(void 0);function o(){let e=(0,l.useContext)(d);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function c(e){let{children:t}=e,[a,o]=(0,l.useState)(null),[c,u]=(0,l.useState)(!0);(0,l.useEffect)(()=>(0,s.hg)(i.j2,e=>{o(e),u(!1)}),[]);let x=async(e,t)=>{try{let a=await (0,s.eJ)(i.j2,e,t),r=a.user;if(r){let e=(0,n.H9)(i.db,"users",r.uid);await (0,n.BN)(e,{uid:r.uid,email:r.email,createdAt:(0,n.O5)()}),console.log("User document created in Firestore for UID:",r.uid)}return a}catch(e){throw console.error("Registration and Firestore doc creation failed:",e),e}};return(0,r.jsx)(d.Provider,{value:{user:a,loading:c,login:(e,t)=>(0,s.x9)(i.j2,e,t),register:x,logout:()=>(0,s.CI)(i.j2)},children:!c&&t})}}},e=>{var t=t=>e(e.s=t);e.O(0,[825,992,158,309,183,822,638,693,441,684,358],()=>t(3320)),_N_E=e.O()}]);