(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[912],{3320:(e,t,r)=>{Promise.resolve().then(r.bind(r,8176))},3741:(e,t,r)=>{"use strict";r.d(t,{$:()=>l});var a=r(5155);function l(e){let{className:t,variant:r="default",size:l="default",children:s,...i}=e,d={default:"bg-blue-600 text-white hover:bg-blue-700/90 dark:bg-blue-500 dark:hover:bg-blue-400/90",outline:"border border-gray-300 dark:border-gray-600 bg-transparent hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-gray-100",ghost:"hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-gray-100"},o={default:"h-10 py-2 px-4",sm:"h-9 px-3 rounded-md",lg:"h-11 px-8 rounded-md",icon:"h-10 w-10"},n=d[r]||d.default,c=o[l]||o.default;return(0,a.jsx)("button",{className:"".concat("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background dark:focus-visible:ring-offset-gray-800"," ").concat(n," ").concat(c," ").concat(t).trim(),...i,children:s})}r(2115)},5494:(e,t,r)=>{"use strict";r.d(t,{A:()=>g});var a=r(5155),l=r(6874),s=r.n(l),i=r(9576),d=r(5695),o=r(7434),n=r(3783),c=r(3428),u=r(3408),x=r(4835);function g(){let{user:e,logout:t}=(0,i.A)(),r=(0,d.useRouter)(),l=async()=>{try{await t(),r.push("/auth/login")}catch(e){console.error("Failed to log out",e)}};return(0,a.jsx)("nav",{className:"bg-white dark:bg-gray-800 shadow-md sticky top-0 z-50",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,a.jsxs)(s(),{href:"/",className:"flex items-center space-x-2 text-2xl font-bold text-blue-600 dark:text-blue-400",children:[(0,a.jsx)(o.A,{size:24}),(0,a.jsx)("span",{children:"CloudPDF"})]}),e&&(0,a.jsxs)("div",{className:"hidden md:flex space-x-1 items-center border-l border-gray-200 dark:border-gray-700 pl-4",children:[(0,a.jsxs)(m,{href:"/dashboard",children:[(0,a.jsx)(n.A,{size:18,className:"mr-1"}),"Dashboard"]}),(0,a.jsxs)(m,{href:"/pdf-viewer",children:[(0,a.jsx)(o.A,{size:18,className:"mr-1"}),"Viewer"]}),(0,a.jsxs)(m,{href:"/pdf-tools/merge",children:[(0,a.jsx)(c.A,{size:18,className:"mr-1"}),"Merge"]}),(0,a.jsxs)(m,{href:"/pdf-tools/split",children:[(0,a.jsx)(u.A,{size:18,className:"mr-1"}),"Split"]})]})]}),(0,a.jsx)("div",{className:"flex items-center",children:e?(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("span",{className:"hidden sm:inline text-sm text-gray-600 dark:text-gray-300",children:e.email}),(0,a.jsx)("button",{onClick:l,title:"Logout",className:"flex items-center p-2 rounded-md text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-700 dark:hover:text-gray-200 transition-colors",children:(0,a.jsx)(x.A,{size:20})})]}):(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(s(),{href:"/auth/login",className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 transition-colors rounded-md",children:"Login"}),(0,a.jsx)(s(),{href:"/auth/register",className:"inline-flex items-center rounded-md bg-blue-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-500 dark:bg-blue-500 dark:hover:bg-blue-400 transition-colors",children:"Register"})]})})]})})})}function m(e){let{href:t,children:r}=e;return(0,a.jsx)(s(),{href:t,className:"flex items-center px-3 py-2 text-sm font-medium text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",children:r})}},6104:(e,t,r)=>{"use strict";r.d(t,{IG:()=>u,db:()=>n,j2:()=>c});var a=r(3915),l=r(5317),s=r(6203),i=r(858),d=r(8616);let o=(0,a.Dk)().length?(0,a.Sx)():(0,a.Wp)({apiKey:"AIzaSyDI7MAPqIvl1cCkwZl_Nr4bYmOArNzIqzM",authDomain:"tactical-elf-457101-s0.firebaseapp.com",projectId:"tactical-elf-457101-s0",storageBucket:"tactical-elf-457101-s0.firebasestorage.app",messagingSenderId:"695823233926",appId:"1:695823233926:web:aeac2bc2b5069d8baa7207",measurementId:"G-JQF8DMHYSF"}),n=(0,l.aU)(o),c=(0,s.xI)(o),u=(0,i.c7)(o);(0,d.FJ)(o)},8176:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>w});var a=r(5155),l=r(2115),s=r(4014),i=r(5404),d=r(9280);r(8851),r(2465);var o=r(5494),n=r(9053),c=r(9576),u=r(6104),x=r(858),g=r(5317),m=r(3741),h=r(2337),f=r(9946);let b=(0,f.A)("type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);var p=r(5339);let y=(0,f.A)("file-check",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);var v=r(1154);let j=(0,f.A)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);var k=r(4123);function w(){let{user:e}=(0,c.A)(),[t,r]=(0,l.useState)(null),[s,f]=(0,l.useState)(null),[w,N]=(0,l.useState)(1),[A,F]=(0,l.useState)(null),[C,S]=(0,l.useState)(!1),[P,z]=(0,l.useState)(0),[D,I]=(0,l.useState)(null),[V,E]=(0,l.useState)(null),[U,M]=(0,l.useState)(null),R=(0,l.useRef)(null),[B,L]=(0,l.useState)("#0000FF"),[H,T]=(0,l.useState)(!1),[$,_]=(0,l.useState)({x:0,y:0,value:"",isVisible:!1,pageNum:1}),[q,O]=(0,l.useState)(!1),G=(0,l.useCallback)(e=>{M(e)},[]),J=async()=>{if(!t||""===$.value.trim()||!U||!R.current){console.error("Missing file, text, page details, or container ref for adding text."),F("Could not add text: Missing required information.");return}O(!0),F(null);try{let e=await t.arrayBuffer(),a=await k.PDFDocument.load(e),l=await a.embedFont(k.StandardFonts.Helvetica),s=a.getPages();if($.pageNum<1||$.pageNum>s.length)throw Error("Invalid page number: ".concat($.pageNum));let i=s[$.pageNum-1],{width:d,height:o}=i.getSize(),n=R.current.getBoundingClientRect(),c=n.width;n.height;let u=d/c,x=$.x,g=$.y,m=x*u,h=o-g*u,f=function(e){let t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16)/255,g:parseInt(t[2],16)/255,b:parseInt(t[3],16)/255}:null}(B);if(!f)throw Error("Invalid text color selected.");console.log("Drawing text: '".concat($.value,"' at (").concat(m.toFixed(2),", ").concat(h.toFixed(2),") with color ").concat(B)),i.drawText($.value,{x:m,y:h,size:12,font:l,color:(0,k.rgb)(f.r,f.g,f.b)});let b=await a.save(),p=new Blob([b],{type:"application/pdf"}),y=new File([p],t.name,{type:"application/pdf"});r(y),_({...$,isVisible:!1,value:""})}catch(e){console.error("Failed to add text to PDF:",e),F("Could not add text to the PDF. ".concat(e.message))}finally{O(!1)}};function K(e){if($.isVisible)return void alert("Please save or cancel the current text before changing pages.");N(t=>t+e)}return(0,a.jsx)(n.A,{children:(0,a.jsxs)("div",{className:"min-h-screen flex flex-col",children:[(0,a.jsx)(o.A,{}),(0,a.jsxs)("main",{className:"flex-grow container mx-auto px-4 sm:px-6 lg:px-8 py-12 w-full",children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold mb-4 text-center text-gray-800 dark:text-gray-200",children:"CloudPDF Viewer & Uploader"}),(0,a.jsxs)("div",{className:"mb-4 flex flex-col sm:flex-row items-center justify-center gap-4 p-4 bg-gray-100 dark:bg-gray-800 rounded-md shadow flex-wrap",children:[(0,a.jsx)("input",{type:"file",onChange:function(e){var t;let a=null==(t=e.target.files)?void 0:t[0];if(a&&"application/pdf"===a.type){let e=new FileReader;e.onload=e=>{var t;(null==(t=e.target)?void 0:t.result)&&(r(new File([new Blob([e.target.result],{type:"application/pdf"})],a.name,{type:"application/pdf"})),F(null),I(null),E(null),f(null),N(1),T(!1),_({x:0,y:0,value:"",isVisible:!1,pageNum:1}))},e.readAsArrayBuffer(a)}else F("Please upload a valid PDF file."),r(null),I(null),E(null)},accept:"application/pdf",className:"block w-full max-w-xs text-sm text-gray-500 dark:text-gray-400 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border file:border-gray-300 dark:file:border-gray-600 file:text-sm file:font-semibold file:bg-white dark:file:bg-gray-700 file:text-blue-700 dark:file:text-blue-300 hover:file:bg-gray-50 dark:hover:file:bg-gray-600"}),(0,a.jsx)(m.$,{onClick:()=>{if(!t||!e)return void I("No file selected or user not logged in.");if($.isVisible)return void I("Please save or cancel the text you are adding before uploading.");S(!0),I(null),E(null),z(0);let r=(0,x.KR)(u.IG,"users/".concat(e.uid,"/pdfs/").concat(t.name)),a=(0,x.bp)(r,t);a.on("state_changed",e=>{z(e.bytesTransferred/e.totalBytes*100)},e=>{console.error("Upload Error:",e),I("Upload failed: ".concat(e.message)),S(!1),z(0)},async()=>{try{let r=await (0,x.qk)(a.snapshot.ref);E(r),console.log("File available at",r);let l=(0,g.rJ)(u.db,"users",e.uid,"uploadedPdfs");await (0,g.gS)(l,{fileName:t.name,downloadURL:r,uploadedAt:(0,g.O5)()}),console.log("File metadata saved to Firestore")}catch(e){console.error("Error getting download URL or saving metadata:",e),I("Upload complete but failed to save metadata or get URL.")}finally{S(!1)}})},disabled:!t||C||H,size:"default",title:H?"Disable 'Add Text' mode before uploading":"Upload current PDF to cloud",children:C?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Uploading..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.A,{className:"mr-2 h-4 w-4"})," Upload to Cloud"]})}),(0,a.jsxs)(m.$,{variant:H?"default":"outline",onClick:()=>{T(!H),_({...$,isVisible:!1})},disabled:!t||C,size:"default",title:"Toggle Add Text Mode",children:[(0,a.jsx)(b,{className:"mr-2 h-4 w-4"})," ",H?"Cancel Text":"Add Text"]}),H&&(0,a.jsxs)("div",{className:"flex items-center gap-2 ml-2 border-l pl-4 dark:border-gray-600",children:[(0,a.jsx)("label",{htmlFor:"textColorPicker",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Color:"}),(0,a.jsx)("input",{type:"color",id:"textColorPicker",value:B,onChange:e=>L(e.target.value),className:"w-8 h-8 border border-gray-300 dark:border-gray-600 rounded cursor-pointer",title:"Select Text Color"})]})]}),C&&(0,a.jsxs)("div",{className:"mb-4 max-w-md mx-auto",children:[(0,a.jsx)("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5",children:(0,a.jsx)("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all duration-300 ease-out",style:{width:"".concat(P,"%")}})}),(0,a.jsxs)("p",{className:"text-center text-sm text-gray-600 dark:text-gray-400 mt-1",children:[Math.round(P),"%"]})]}),D&&(0,a.jsxs)("div",{className:"bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-200 px-4 py-2 rounded text-sm text-center mb-4 max-w-md mx-auto flex items-center justify-center gap-2",children:[(0,a.jsx)(p.A,{size:16})," ",D]}),V&&(0,a.jsxs)("div",{className:"bg-green-100 dark:bg-green-900 border border-green-400 dark:border-green-700 text-green-700 dark:text-green-200 px-4 py-2 rounded text-sm text-center mb-4 max-w-md mx-auto flex items-center justify-center gap-2",children:[(0,a.jsx)(y,{size:16})," Upload Successful! Metadata saved."]}),A&&(0,a.jsxs)("div",{className:"w-full max-w-4xl bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-200 px-4 py-3 rounded text-center mb-4 flex items-center justify-center gap-2",children:[(0,a.jsx)(p.A,{size:16})," ",A]}),(0,a.jsxs)("div",{className:"flex flex-col items-center relative",children:[t&&(0,a.jsxs)("div",{ref:R,className:"border shadow-lg overflow-auto max-w-full bg-white dark:bg-gray-900 relative",style:{maxHeight:"calc(100vh - 300px)",cursor:H?"crosshair":"default"},onClick:e=>{if(!H||!U||!R.current)return;let t=R.current.getBoundingClientRect();U.width,t.width,_({x:e.clientX-t.left-5,y:e.clientY-t.top-10,value:"",isVisible:!0,pageNum:w})},children:[(0,a.jsx)(i.A,{file:t,onLoadSuccess:function(e){let{numPages:t}=e;f(t),N(1),F(null),T(!1),_({x:0,y:0,value:"",isVisible:!1,pageNum:1})},onLoadError:function(e){console.error("Error loading PDF document:",e),F("Failed to load PDF document. Ensure it is a valid PDF file."),r(null),f(null),T(!1)},loading:(0,a.jsx)(v.A,{className:"h-8 w-8 animate-spin text-blue-600 mx-auto my-10"}),children:(0,a.jsx)(d.A,{pageNumber:w,renderTextLayer:!1,onLoadSuccess:G})}),$.isVisible&&$.pageNum===w&&(0,a.jsxs)("div",{className:"absolute p-1 bg-white dark:bg-gray-800 border border-blue-500 shadow-lg rounded",style:{left:"".concat($.x,"px"),top:"".concat($.y,"px"),zIndex:10},children:[(0,a.jsx)("textarea",{value:$.value,onChange:e=>_({...$,value:e.target.value}),placeholder:"Enter text...",autoFocus:!0,className:"w-48 h-16 p-1 border border-gray-300 dark:border-gray-600 rounded focus:outline-none focus:ring-1 focus:ring-blue-500 text-sm dark:bg-gray-700 dark:text-white placeholder:text-gray-500 dark:placeholder:text-gray-400",onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),J())}}),(0,a.jsxs)("div",{className:"mt-1 flex justify-end gap-1",children:[(0,a.jsx)(m.$,{size:"sm",variant:"ghost",onClick:()=>_({...$,isVisible:!1,value:""}),title:"Cancel",className:"px-2 py-1 text-xs",children:"Cancel"}),(0,a.jsxs)(m.$,{size:"sm",onClick:J,disabled:q||""===$.value.trim(),title:"Save Text (Enter)",className:"px-2 py-1 text-xs",children:[q?(0,a.jsx)(v.A,{className:"h-3 w-3 animate-spin"}):(0,a.jsx)(j,{className:"h-3 w-3"}),"Save"]})]})]})]}),t&&s&&(0,a.jsxs)("div",{className:"mt-4 flex items-center gap-4",children:[(0,a.jsx)(m.$,{variant:"outline",size:"sm",disabled:w<=1||$.isVisible,onClick:function(){K(-1)},title:$.isVisible?"Save or cancel text first":"Previous Page",children:"Previous"}),(0,a.jsxs)("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:["Page ",w," of ",s]}),(0,a.jsx)(m.$,{variant:"outline",size:"sm",disabled:w>=s||$.isVisible,onClick:function(){K(1)},title:$.isVisible?"Save or cancel text first":"Next Page",children:"Next"})]}),!t&&!A&&(0,a.jsx)("div",{className:"text-center text-gray-500 dark:text-gray-400 mt-10 border border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-10",children:(0,a.jsx)("p",{children:"Select a PDF file using the button above to view and upload."})})]})]})]})})}s.EA.workerSrc="//unpkg.com/pdfjs-dist@".concat(s.rE,"/build/pdf.worker.min.mjs")},9053:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var a=r(5155),l=r(2115),s=r(5695),i=r(9576);function d(e){let{children:t}=e,{user:r,loading:d}=(0,i.A)(),o=(0,s.useRouter)();return((0,l.useEffect)(()=>{d||r||o.push("/auth/login")},[r,d,o]),d)?(0,a.jsx)("div",{className:"flex h-screen items-center justify-center",children:(0,a.jsx)("div",{className:"h-8 w-8 animate-spin rounded-full border-b-2 border-t-2 border-blue-600"})}):r?(0,a.jsx)(a.Fragment,{children:t}):null}},9576:(e,t,r)=>{"use strict";r.d(t,{A:()=>n,AuthProvider:()=>c});var a=r(5155),l=r(2115),s=r(6203),i=r(6104),d=r(5317);let o=(0,l.createContext)(void 0);function n(){let e=(0,l.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function c(e){let{children:t}=e,[r,n]=(0,l.useState)(null),[c,u]=(0,l.useState)(!0);(0,l.useEffect)(()=>(0,s.hg)(i.j2,e=>{n(e),u(!1)}),[]);let x=async(e,t)=>{try{let r=await (0,s.eJ)(i.j2,e,t),a=r.user;if(a){let e=(0,d.H9)(i.db,"users",a.uid);await (0,d.BN)(e,{uid:a.uid,email:a.email,createdAt:(0,d.O5)()}),console.log("User document created in Firestore for UID:",a.uid)}return r}catch(e){throw console.error("Registration and Firestore doc creation failed:",e),e}},g=async()=>{let e=new s.HF;try{let t=await (0,s.df)(i.j2,e),r=t.user;if(r){let e=(0,d.H9)(i.db,"users",r.uid);await (0,d.BN)(e,{uid:r.uid,email:r.email,displayName:r.displayName,photoURL:r.photoURL,createdAt:(0,d.O5)(),provider:"google.com"},{merge:!0}),console.log("User document updated/created in Firestore for Google Sign-In UID:",r.uid)}return t}catch(e){throw console.error("Google Sign-In failed:",e),e}};return(0,a.jsx)(o.Provider,{value:{user:r,loading:c,login:(e,t)=>(0,s.x9)(i.j2,e,t),register:x,logout:()=>(0,s.CI)(i.j2),loginWithGoogle:g},children:!c&&t})}}},e=>{var t=t=>e(e.s=t);e.O(0,[825,992,158,309,542,822,638,693,441,684,358],()=>t(3320)),_N_E=e.O()}]);